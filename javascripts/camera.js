var bgCameraStream=null,timeInterval=null,Bg=chrome.extension.getBackgroundPage();function getBg(t){chrome.runtime.getBackgroundPage(function(e){t(e)})}chrome.runtime.onMessage.addListener(function(e,t,n){"stream-ready"==e.action?(bgCameraStream=Bg.cameraStream,video.srcObject=Bg.cameraStream):"stop-camera"===e.action&&(bgCameraStream=null,window.close())});var params=new URLSearchParams(window.location.search),type=params.get("type");if("camera"===type){document.body.classList.add("camera"),timeInterval=setInterval(function(){document.getElementById("time").innerText=Bg.recordingTime},1e3),window.addEventListener("beforeunload",function(){}),document.getElementById("stop").addEventListener("click",function(){Bg.stopStream()},!1);var pauseBtn=document.getElementById("pause"),resumeBtn=document.getElementById("resume"),stopBtn=document.getElementById("stop");pauseBtn.addEventListener("click",function(){pauseBtn.style.display="none",resumeBtn.style.display="block",Bg.pauseScreenRecording()},!1),resumeBtn.addEventListener("click",function(){resumeBtn.style.display="none",pauseBtn.style.display="block",Bg.resumeScreenRecording()},!1)}var video=document.getElementById("video");video.onloadedmetadata=function(){"pip"===type&&video.requestPictureInPicture()},video.addEventListener("leavepictureinpicture",function(){Bg.stopCameraStream(),window.close()}),chrome.runtime.getBackgroundPage(function(e){e.cameraStream&&(bgCameraStream=e.cameraStream,video.srcObject=e.cameraStream)});